"use strict";(self.webpackChunkdomoupravitel_front_end=self.webpackChunkdomoupravitel_front_end||[]).push([[937],{937:(J,f,o)=>{o.r(f),o.d(f,{AuthModule:()=>P});var d=o(6895),s=o(433),r=o(2487),g=o(3472),h=o(2278),e=o(4650),c=o(6679);let w=(()=>{class u{constructor(n,t,i){this.router=t,this.user=i,this.credentials=n.group({username:["",s.kI.required],password:["",s.kI.required]})}onSubmit(){this.credentials.valid&&this.user.login(this.credentials.value.username,this.credentials.value.password).subscribe({next:()=>{this.router.navigate(["/"])},error:n=>{this.credentials.reset()}})}static#e=this.\u0275fac=function(t){return new(t||u)(e.Y36(s.qu),e.Y36(g.F0),e.Y36(c.K))};static#t=this.\u0275cmp=e.Xpm({type:u,selectors:[["app-login"]],decls:17,vars:2,consts:[[1,"container"],[3,"formGroup","ngSubmit"],["type","border"],["igxInput","","name","username","type","text","formControlName","username"],["igxLabel","","for","username"],["igxInput","","name","password","type","password","formControlName","password"],["igxLabel","","for","password"],[1,"actions"],["igxButton","raised","type","submit","igxRipple","",3,"disabled"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"form",1),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(2,"igx-input-group",2),e._UZ(3,"input",3),e.TgZ(4,"label",4),e._uU(5,"\u041f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u0441\u043a\u043e \u0438\u043c\u0435"),e.qZA(),e.TgZ(6,"igx-hint"),e._uU(7,"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0432\u0430\u0448\u0435\u0442\u043e \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u0441\u043a\u043e \u0438\u043c\u0435"),e.qZA()(),e.TgZ(8,"igx-input-group",2),e._UZ(9,"input",5),e.TgZ(10,"label",6),e._uU(11,"\u041f\u0430\u0440\u043e\u043b\u0430"),e.qZA(),e.TgZ(12,"igx-hint"),e._uU(13,"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0432\u0430\u0448\u0430\u0442\u0430 \u043f\u0430\u0440\u043e\u043b\u0430"),e.qZA()(),e.TgZ(14,"div",7)(15,"button",8),e._uU(16,"\u0412\u043b\u0435\u0437"),e.qZA()()()()),2&t&&(e.xp6(1),e.Q6J("formGroup",i.credentials),e.xp6(14),e.Q6J("disabled",!i.credentials.valid))},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,r.ZpI,r.iZ5,r.kPw,r.AKS,r.Xjp,r.p9i],styles:[".container[_ngcontent-%COMP%]{max-width:600px;background-color:hsla(var(--igx-surface-500));margin:2rem auto;padding:2rem}.actions[_ngcontent-%COMP%]{margin-top:1rem;display:flex;justify-content:flex-end}igx-input-group[_ngcontent-%COMP%]{margin-bottom:1rem}"]})}return u})();var x=o(590),m=o(8801);function _(u,l){if(1&u&&e._uU(0),2&u){const n=l.cell,t=e.oxw();e.hij(" ",t.parseRole(n.value)," ")}}function Z(u,l){if(1&u&&(e.TgZ(0,"igx-select-item",12),e._uU(1),e.qZA()),2&u){const n=l.$implicit;e.Q6J("value",n.value),e.xp6(1),e.hij(" ",n.name," ")}}function v(u,l){if(1&u){const n=e.EpF();e.TgZ(0,"igx-select",10),e.NdJ("ngModelChange",function(i){const p=e.CHM(n).cell;return e.KtG(p.editValue=i)}),e.YNc(1,Z,2,2,"igx-select-item",11),e.qZA()}if(2&u){const n=l.cell,t=e.oxw();e.Q6J("ngModel",n.editValue),e.xp6(1),e.Q6J("ngForOf",t.roles)}}const b=["toast"];function A(u,l){1&u&&(e.TgZ(0,"igx-hint"),e._uU(1,"\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0441\u044a\u0449\u0430\u0442\u0430 \u043f\u0430\u0440\u043e\u043b\u0430"),e.qZA())}const U=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:w},{path:"user-manager",component:(()=>{class u{constructor(n){this.user=n,this.roles=Object.keys(m.u).filter(t=>!isNaN(Number(t))).map(t=>parseInt(t)===m.u.Admin?{name:"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440",value:0}:parseInt(t)===m.u.Moderator?{name:"\u041c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440",value:1}:{name:"\u041f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b",value:2})}ngOnInit(){this.users=this.user.all()}userAdded(n){this.user.add(n.data).pipe((0,x.P)()).subscribe()}userEdited(n){this.user.update(n.newValue).pipe((0,x.P)()).subscribe()}parseRole(n){return 0===n?"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440":1===n?"\u041c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440":"\u041f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b"}static#e=this.\u0275fac=function(t){return new(t||u)(e.Y36(c.K))};static#t=this.\u0275cmp=e.Xpm({type:u,selectors:[["app-user-manager"]],decls:12,vars:6,consts:[[1,"container"],["width","800px","height","600px",3,"data","rowEditable","primaryKey","rowAdded","rowEditDone"],["field","id"],["field","userName"],["field","role"],["igxCell",""],["igxCellEditor",""],["field","password"],["actionstrip",""],[3,"addRow"],["type","border",2,"height","max-content","min-width","min-content",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"igx-grid",1),e.NdJ("rowAdded",function(p){return i.userAdded(p)})("rowEditDone",function(p){return i.userEdited(p)}),e.ALo(2,"async"),e._UZ(3,"igx-column",2)(4,"igx-column",3),e.TgZ(5,"igx-column",4),e.YNc(6,_,1,1,"ng-template",5),e.YNc(7,v,2,2,"ng-template",6),e.qZA(),e._UZ(8,"igx-column",7),e.TgZ(9,"igx-action-strip",null,8),e._UZ(11,"igx-grid-editing-actions",9),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("data",e.lcZ(2,4,i.users))("rowEditable",!0)("primaryKey","id"),e.xp6(10),e.Q6J("addRow",!0))},dependencies:[d.sg,s.JJ,s.On,r.ECH,r.kkr,r.EyO,r.rmB,r.zNI,r.pz6,r.cTL,r.Ap$,d.Ov],styles:[".container[_ngcontent-%COMP%]{max-width:1140px;height:100%;overflow:auto;background-color:hsla(var(--igx-surface-500))}"]})}return u})(),canActivate:[h.u]},{path:"user-settings",component:(()=>{class u{constructor(n,t){this.userService=t,this.passwordConfirming=i=>i.get("newPassword")?.value!=i.get("repeatPassword")?.value?{invalid:!0}:null,this.updatePassword=n.group({password:["",s.kI.required],newPassword:["",[s.kI.required,s.kI.minLength(6)]],repeatPassword:["",[s.kI.required,s.kI.minLength(6)]]},{validators:this.passwordConfirming})}onSubmit(){const n=this.updatePassword.value;this.userService.changePassword(n.password,n.newPassword,n.repeatPassword).subscribe({next:t=>{this.toast.textMessage="\u041f\u0430\u0440\u043e\u043b\u0430\u0442\u0430 \u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0435\u043d\u0430!",this.toast?.open(),this.clearForm()},error:t=>{let i="";switch(t.error){case"Bad credentials":i="\u0412\u044a\u0432\u0435\u043b\u0438 \u0441\u0442\u0435 \u0433\u0440\u0435\u0448\u043d\u0430 \u043f\u0430\u0440\u043e\u043b\u0430. \u041c\u043e\u043b\u044f \u043e\u043f\u0438\u0442\u0430\u0439\u0442\u0435 \u043e\u0442\u043d\u043e\u0432\u043e!";break;case"Not matching passwords":i="\u041d\u043e\u0432\u0430\u0442\u0430 \u0438 \u0441\u0442\u0430\u0440\u0430\u0442\u0430 \u043f\u0430\u0440\u043e\u043b\u0430 \u043d\u0435 \u0441\u0438 \u0441\u044a\u0432\u043f\u0430\u0434\u0430\u0442. \u0414\u043e\u0431\u044a\u0440 \u043e\u043f\u0438\u0442 :)";break;default:i="\u041f\u0430\u0440\u043e\u043b\u0430\u0442\u0430 \u043d\u0435 \u0435 \u043e\u0431\u043d\u043e\u0432\u0435\u043d\u0430! \u041e\u043f\u0438\u0442\u0430\u0439\u0442\u0435 \u043e\u0442\u043d\u043e\u0432\u043e."}this.toast.textMessage=i,this.toast?.open(),this.clearForm()}})}clearForm(){this.updatePassword.reset({password:"",newPassword:"",repeatPassword:""})}static#e=this.\u0275fac=function(t){return new(t||u)(e.Y36(s.qu),e.Y36(c.K))};static#t=this.\u0275cmp=e.Xpm({type:u,selectors:[["app-user-settings"]],viewQuery:function(t,i){if(1&t&&e.Gf(b,7,r.JfS),2&t){let a;e.iGM(a=e.CRH())&&(i.toast=a.first)}},decls:28,vars:7,consts:[[1,"container"],["igxCardHeaderTitle",""],[3,"formGroup","ngSubmit"],[1,"inputs"],["type","border"],["igxInput","","name","password","type","password","formControlName","password"],["igxLabel","","for","password"],["igxInput","","name","newPassword","type","password","formControlName","newPassword"],["igxLabel","","for","newPassword"],["igxInput","","name","repeatPassword","type","password","formControlName","repeatPassword"],["igxLabel","","for","repeatPassword"],[4,"ngIf"],[3,"reverse"],["type","button","igxButton","flat","igxRipple","",3,"igxRippleCentered","click"],["igxButton","raised","igxRipple","",3,"igxRippleCentered","disabled"],["toast",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"igx-card")(2,"igx-card-header")(3,"h5",1),e._uU(4),e.qZA()(),e.TgZ(5,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(6,"igx-card-content")(7,"div",3)(8,"igx-input-group",4),e._UZ(9,"input",5),e.TgZ(10,"label",6),e._uU(11,"\u0421\u0442\u0430\u0440\u0430 \u043f\u0430\u0440\u043e\u043b\u0430"),e.qZA()(),e.TgZ(12,"igx-input-group",4),e._UZ(13,"input",7),e.TgZ(14,"label",8),e._uU(15,"\u041d\u043e\u0432\u0430 \u043f\u0430\u0440\u043e\u043b\u0430"),e.qZA()(),e.TgZ(16,"igx-input-group",4),e._UZ(17,"input",9),e.TgZ(18,"label",10),e._uU(19,"\u041e\u0442\u043d\u043e\u0432\u043e \u043d\u043e\u0432\u0430\u0442\u0430 \u043f\u0430\u0440\u043e\u043b\u0430"),e.qZA(),e.YNc(20,A,2,0,"igx-hint",11),e.qZA()()(),e.TgZ(21,"igx-card-actions",12)(22,"button",13),e.NdJ("click",function(){return i.clearForm()}),e._uU(23,"\u0418\u0437\u0447\u0438\u0441\u0442\u0438"),e.qZA(),e.TgZ(24,"button",14),e._uU(25,"\u041f\u043e\u0442\u0432\u044a\u0440\u0434\u0438"),e.qZA()()()(),e._UZ(26,"igx-toast",null,15),e.qZA()),2&t&&(e.xp6(4),e.Oqu(i.userService.userName),e.xp6(1),e.Q6J("formGroup",i.updatePassword),e.xp6(15),e.Q6J("ngIf",!i.updatePassword.valid),e.xp6(1),e.Q6J("reverse",!0),e.xp6(1),e.Q6J("igxRippleCentered",!0),e.xp6(2),e.Q6J("igxRippleCentered",!0)("disabled",!i.updatePassword.valid))},dependencies:[d.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,r.gzP,r.qYk,r.TrA,r.T1O,r.Hb8,r.ZpI,r.iZ5,r.kPw,r.AKS,r.Xjp,r.p9i,r.JfS],styles:[".container[_ngcontent-%COMP%]{max-width:600px;background-color:hsla(var(--igx-surface-500));margin:2rem auto;padding:2rem}.inputs[_ngcontent-%COMP%]{display:flex;height:200px;flex-direction:column;justify-content:space-between}"]})}return u})(),canActivate:[h.u]}];let y=(()=>{class u{static#e=this.\u0275fac=function(t){return new(t||u)};static#t=this.\u0275mod=e.oAB({type:u});static#u=this.\u0275inj=e.cJS({imports:[g.Bz.forChild(U),g.Bz]})}return u})(),P=(()=>{class u{static#e=this.\u0275fac=function(t){return new(t||u)};static#t=this.\u0275mod=e.oAB({type:u});static#u=this.\u0275inj=e.cJS({imports:[d.ez,y,s.u5,s.UX,r.Xhl,r.Vfr,r.QoJ,r.LtP,r.Z2X,r.HJ2,r.oiK]})}return u})()}}]);